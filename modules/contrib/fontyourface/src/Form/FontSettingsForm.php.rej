--- src/Form/FontSettingsForm.php
+++ src/Form/FontSettingsForm.php
@@ -87,20 +94,22 @@ class FontSettingsForm extends ConfigFormBase {
     // Set the module weight. There is some general Drupal funk around module
     // weights.
     module_set_weight('fontyourface', 1);
-    foreach (\Drupal::moduleHandler()->getImplementations('fontyourface_api') as $module_name) {
-      module_set_weight($module_name, 10);
-    }
-    foreach (\Drupal::moduleHandler()->getImplementations('fontyourface_import') as $module_name) {
-      $form['imports']['import_' . $module_name] = [
+    \Drupal::moduleHandler()->invokeAllWith(self::HOOK_API, function (callable $hook, string $module) {
+      module_set_weight($module, 10);
+      }
+    );
+    \Drupal::moduleHandler()->invokeAllWith(self::HOOK_IMPORT, function (callable $hook, string $module) {
+      $form['imports']['import_' . $module] = [
         '#type' => 'submit',
-        '#value' => $this->t('Import from @module', ['@module' => $module_name]),
+        '#value' => $this->t('Import from @module', ['@module' => $module]),
         '#attributes' => [
           'style' => 'margin: 10px;',
         ],
         '#prefix' => '<div>',
         '#suffix' => '</div>',
       ];
-    }
+      }
+    );
 
     $form['imports']['import'] = [
       '#type' => 'submit',
@@ -127,16 +136,16 @@ class FontSettingsForm extends ConfigFormBase {
       'operations' => [],
       'finished' => '\Drupal\fontyourface\Form\FontSettingsForm::importFinished',
     ];
-    foreach (\Drupal::moduleHandler()->getImplementations('fontyourface_import') as $module_name) {
-      if ($op == $this->t('Import all fonts') || $op == $this->t('Import from @module', ['@module' => $module_name])) {
+    \Drupal::moduleHandler()->invokeAllWith(self::HOOK_IMPORT, function (callable $hook, string $module) use ($op) {
+      if ($op == $this->t('Import all fonts') || $op == $this->t('Import from @module', ['@module' => $module])) {
         $batch['operations'][] = [
           '\Drupal\fontyourface\Form\FontSettingsForm::importFromProvider',
           [
-            $module_name,
+            $module,
           ],
         ];
       }
-    }
+    });
     if (!empty($batch['operations'])) {
       batch_set($batch);
     }
--- src/Form/FontSettingsForm.php
+++ src/Form/FontSettingsForm.php
@@ -89,9 +89,8 @@ class FontSettingsForm extends ConfigFormBase {
     module_set_weight('fontyourface', 1);
     \Drupal::moduleHandler()->invokeAllWith(self::HOOK_API, function (callable $hook, string $module) {
       module_set_weight($module, 10);
-      }
-    );
-    \Drupal::moduleHandler()->invokeAllWith(self::HOOK_IMPORT, function (callable $hook, string $module) {
+    });
+    \Drupal::moduleHandler()->invokeAllWith(self::HOOK_IMPORT, function (callable $hook, string $module) use (&$form) {
       $form['imports']['import_' . $module] = [
         '#type' => 'submit',
         '#value' => $this->t('Import from @module', ['@module' => $module]),
@@ -129,7 +128,7 @@ class FontSettingsForm extends ConfigFormBase {
       'operations' => [],
       'finished' => '\Drupal\fontyourface\Form\FontSettingsForm::importFinished',
     ];
-    \Drupal::moduleHandler()->invokeAllWith(self::HOOK_IMPORT, function (callable $hook, string $module) use ($op) {
+    \Drupal::moduleHandler()->invokeAllWith(self::HOOK_IMPORT, function (callable $hook, string $module) use ($op, &$batch) {
       if ($op == $this->t('Import all fonts') || $op == $this->t('Import from @module', ['@module' => $module])) {
         $batch['operations'][] = [
           '\Drupal\fontyourface\Form\FontSettingsForm::importFromProvider',
